# template-test-on-linux.yaml
# Run all unit tests across the LibsAndSamples.sln project on Linux platform

parameters:
  BuildConfiguration: 'Release'

steps:

- task: UseDotNet@2
  displayName: 'Use the latest .NET 8'
  inputs:
    version: 8.x

- task: DownloadPipelineArtifact@0
  displayName: Download Artifacts from Windows Build
  inputs:
    artifactName: drop
    downloadPath: $(System.DefaultWorkingDirectory)/drop

# VSTest@2 is supported only on Windows 
- script: |
    ls '$(System.DefaultWorkingDirectory)'
    ls '$(System.DefaultWorkingDirectory)/drop/'
    dotnet test **/Microsoft.Identity.Test.Unit/bin/**/net8.0/Microsoft.Identity.Test.Unit.dll --configuration Release --collect:"XPlat Code Coverage" --settings build/CodeCoverage.runsettings
  displayName: 'Run unit tests .NET'
